<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta id="sysviewport" name="viewport" content="initial-scale=0.79, minimum-scale=0.79, maximum-scale=0.79, user-scalable=no, width=device-width, height=device-height">
    <title>Sonnenmoor Gewinnspiel</title>
    <style>
        @font-face {
            font-family: MainFont;
            src: url("./Regular.otf");
        }

        html {
            box-sizing: border-box;
        }

        *, *:before, *:after {
            box-sizing: inherit;
        }

        body {
            margin: 0;
            background: #444;
        }

            body * {
                font-family: MainFont;
            }

        #gameContainer {
            width: 100vw;
            height: calc(var(--vh, 1vh) * 100);
        }

        canvas {
            width: 100vw;
            height: calc(var(--vh, 1vh) * 100);
            display: block;
        }
            /* try to handle mobile dialog */
            canvas + * {
                z-index: 2;
            }

        .logo {
            display: block;
            max-width: 100vw;
            max-height: 70vh;
        }

        .progress {
            margin: 1.5em;
            margin-left: -25vw;
            border: 1px solid #427555;
            width: 50vw;
            position: fixed;
            bottom: 20px;
            display: none;
            left: 50%;
        }

            .progress .full {
                margin: 2px;
                background: #427555;
                height: 1em;
                transform-origin: top left;
            }

        #loader {
            position: absolute;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .spinner,
        .spinner:after {
            border-radius: 50%;
            width: 5em;
            height: 5em;
        }

        .spinner {
            margin: 10px;
            font-size: 10px;
            position: relative;
            text-indent: -9999em;
            border-top: 1.1em solid rgba(255, 255, 255, 0.2);
            border-right: 1.1em solid rgba(255, 255, 255, 0.2);
            border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
            border-left: 1.1em solid #ffffff;
            transform: translateZ(0);
            animation: spinner-spin 1.1s infinite linear;
        }

        @keyframes spinner-spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        #form {
            margin: 0;
            position: absolute;
            top: 50%;
            left: 50%;
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
            font-size: 3vh;
            width: 40%;
        }


        .lastPart {
            position: relative;
            height: 100vh;
        }

        input.checkbox {
            width: 3vh;
            height: 3vh;
        }

        #termsDiv {
            font-size: 2.5vh;
            width: 80%;
            margin: auto;
        }

        #finished {
            margin: 0;
            position: absolute;
            top: 50%;
            left: 50%;
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
            font-size: 3vh;
            width: 40%;
            text-align: center;
        }

        .inputField {
            height: 120%;
            width: 100%;
            line-height: 100%;
            font-size: 150%;
            margin-top: 3px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-block-color: gray;
        }

        .inputFields {
            margin-bottom: 20px;
        }

        .centerText {
            text-align: center;
            font-size: 2vh;
        }

        #notifications {
            margin-top: 30px;
        }

        button {
            margin-top: 20px;
            width: 50%;
            font-size: 110%;
            display: block;
            margin-left: auto;
            margin-right: auto;
            background-color: rgba(240,161,82,255);
            border-radius: 8px;
            padding-top: 10px;
            padding-bottom: 10px;
            width: 80%;
            font-size: 130%;
            color: white;
        }

        body {
            background-image: url("./Assets/BG_Web_Left.png"), url("./Assets/BG_Web_Right.png");
            background-attachment: fixed;
            background-repeat: no-repeat, no-repeat;
            background-position: left, right;
            background-size: 40%, 30%;
            background-color: white;
        }


        @media (max-aspect-ratio : 16/9) {
            body {
                background-image: url("./Assets/BG_Web_Left.png");
                background-attachment: fixed;
                background-repeat: no-repeat;
                background-size: cover;
                background-color: white;
            }
        }

        @media (max-aspect-ratio : 8/9) {
            body * {
                font-size: 2.5vh;
            }

            #form {
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
                font-size: 1.3vh;
                width: 80vw;
            }

            #finished {
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
                font-size: 1.3vh;
                width: 100%;
            }
        }
    </style>
    <script src="./Assets/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div id="gameContainer"></div>
    <div id="loader">
        <div class="spinner"></div>
        <div class="progress"><div class="full"></div></div>
    </div>
    <div class="lastPart" hidden>
        <div id="registration">
            <form action="https://gewinnspiel.sonnenmoor.at/Register/register.php" id="form" method="POST">
                <div class="inputFields">
                    <label for="surname">
                        Nachname*
                    </label><br>
                    <input type="text" name="surname" id="surname" placeholder="Nachname" class="inputField" required>
                    <label for="forename">
                        Vorname*
                    </label><br>
                    <input type="text" name="forename" id="forename" placeholder="Vorname" class="inputField" required>
                    <label for="email">
                        E-Mail*
                    </label><br>
                    <input type="email" name="email" id="email" placeholder="E-Mail" class="inputField" required>
                </div>
                <input type="checkbox" class="checkbox" id="terms" name="terms" value="terms" required>
                <label for="terms">
                    * <b>
                        Ja, ich akzeptiere die Teilnahmebedingungen.
                    </b>
                </label><br>
                <p class="linkTerms"><u>Hier zu den Teilnahmebedingungen.</u></p>
                <input type="checkbox" class="checkbox" id="notifications" name="notifications" value="notifications">
                <label for="notifications">
                    <b>SonnenMoor Newsletter:</b> Ich möchte gerne weitere Informationen über Gesundheit, Moor und Kräuter von Sonnenmoor erhalten.
                </label><br>
                <div>
                    <button>Jetzt teilnehmen!</button>
                </div>
                <p>Alle mit einem (*) gekennzeichneten Felder sind Pflichtfelder. </p>
            </form>
        </div>
        <div id="termsDiv">
            <button id="backTerms">Zurück</button>
            <p>
                Gewinnspielrichtlinien GEWINNSPIEL – TEILNAHME UND DATENSCHUTZBEDINGUNGEN der
                SonnenMoor Vertriebs- und Verwertungs-GmbH
                Für die Teilnahme am SonnenMoor Gewinnspiel – Gewinne den Moorschatz gelten folgende
                Bedingungen:
                Veranstalter
                Veranstalter dieses Gewinnspiels ist die SonnenMoor Vertriebs- und Verwertungs-GmbH, Landstraße
                14, 5102 Anthering. Mit der Teilnahme am Gewinnspiel erklärt sich der Teilnehmer mit den folgenden Bestimmungen und Teilnahmebedingungen einverstanden: Die Teilnahme an diesem Gewinnspiel ist kostenlos und unabhängig davon, ob Sie die Dienstleistungen oder Produkte der SonnenMoor Vertriebs- und Verwertungs-GmbH nutzen.
                Teilnehmer im Sinne des Gewinnspiels ist diejenige natürliche Person, die im Teilnahmezeitraum die die im Spiel eingebauten Fragen beantwortet. Teilnahmeberechtigt sind natürliche Personen, die zum Zeitpunkt der Teilnahme mindestens 18 Jahre alt sind. Angestellte des Veranstalters und Mitarbeiter von Partnerunternehmen sind von der Teilnahme ausgeschlossen. Das Gewinnspiel beginnt am 1.10. um 8 Uhr und endet am 29.10. 8 Uhr (Teilnahmezeitraum). Im Fall einer schuldhaften Verletzung der Teilnahmebedingungen ist der Veranstalter berechtigt, den Teilnehmer mit sofortiger Wirkung auszuschließen.
                III. Gewinn und Gewinnermittlung
                Je nach Ihrem erfolgreichen Punkte-Score nehmen Sie an der Verlosung folgender
                Moor- und Kräuterschätze teil:
                28-31 Punkte Verlosung von 5 Geschenkboxen mit Moor- und Kräuterschätzen im Wert von 150,--
                21-27 Punkte Verlosung von 10 Geschenkboxen mit Moor- und Kräuterschätzen im Wert von 100,--
                15-20 Punkte Verlosung von 15 Geschenkboxen mit Moor- und Kräuterschätzen im Wert von 50,--
                Die Ziehung der Gewinner erfolgt am 3.11.2021. Die Gewinner werden schriftlich per Email Nachricht kontaktiert. Bestätigt der Gewinner den Gewinn nicht innerhalb von fünf Werktagen, so verfällt der Gewinn und ein anderer Teilnehmer wird durch ein erneutes Losverfahren als Gewinner ermittelt. Der Gewinnanspruch ist nicht übertragbar. Eine Barauszahlung, Änderung oder Umtausch des Gewinns ist ausgeschlossen. Sämtliche mit dem Gewinn oder seiner Entgegennahme bzw. Nutzung entstehenden Betriebs-, Neben- und Folgekosten trägt der Teilnehmer.
                Datensicherheit und Datenschutz
                Die personenbezogenen Daten der Teilnehmer werden vom Veranstalter unter Beachtung der datenschutzrechtlichen Bestimmungen genutzt und erhoben. Die personenbezogenen Daten beinhalten Namen und die E-Mail-Adresse.
                Nach Registrierung Ihrer Daten erfolgt eine Verarbeitung der oben angeführten Daten durch den datenschutzrechtlich Verantwortlichen SonnenMoor Vertriebs- und Verwertungs-GmbH, Landstraße
                14, 5102 Anthering , zum Zweck der Durchführung des Gewinnspiels auf Grundlage des Gewinnspielvertrages bis Abschluss des Gewinnspiels. Es erfolgt eine Weiterverarbeitung der Daten zum Zweck der Direktwerbung, welche mit dem ursprünglichen Verarbeitungszweck vereinbar ist, auf derselben Rechtsgrundlage bis auf Widerspruch.
                Es besteht keine gesetzliche oder vertragliche Verpflichtung zur Bereitstellung der personenbezogenen Daten. Die Nichtbereitstellung hat lediglich zur Folge, dass Sie am Gewinnspiel nicht teilnehmen bzw. in der Folge keine Direktwerbung erhalten.
                Durch Ankreuzen der Checkbox willigen Sie in die Verarbeitung der oben angeführten personenbezogenen Daten zum Zweck der Zusendung eines E-Mail-Newsletters durch den datenschutzrechtlich Verantwortlichen SonnenMoor Vertriebs- und Verwertungs-GmbH, Landstraße
                14, 5102 Anthering , auf Grundlage Ihrer Einwilligung bis auf Widerruf bzw. Widerspruch ein.
                Es besteht keine gesetzliche oder vertragliche Verpflichtung zur Bereitstellung der personenbezogenen Daten. Die Nichteinwilligung hat lediglich zur Folge, dass Sie keinen E-Mail- Newsletter erhalten.
                Eine Weitergabe an andere Empfänger erfolgt nicht.
                Mit der Teilnahme an diesem Gewinnspiel willigt der Teilnehmer ein, dass SonnenMoor den
                Gewinner per E-Mail-Nachricht kontaktieren darf.
                Abbruch und Änderung des Gewinnspiels
                Der Veranstalter ist berechtigt, das Gewinnspiel ohne vorherige Ankündigung und unverzüglich aus wichtigem Grund abzubrechen. Das Gewinnspiel kann auch aufgrund höherer Gewalt oder sonstiger gesetzlicher Gründe eingestellt werden.
                Sonstiges
                Sollten einzelne Bestimmungen der Teilnahmebedingungen unwirksam sein oder werden, bleibt die Geltung der übrigen Bestimmungen hiervon unberührt. An die Stelle der unwirksamen Bestimmung tritt eine im Einzelfall angemessene Regelung, die dem Zweck der unwirksamen Bestimmung am ehesten entspricht.
            </p>
        </div>
        <div id="finished">
            <p id="finishedText">Herzlichen Glückwunsch! Sie nehmen am Gewinnspiel teil!</p>
            <button id="backToWebsite">Zurück zur Website!</button>
        </div>
        <script>
            window.onload = () => {
                $("#termsDiv").hide();
                $("#finished").hide();
                $("#registration").hide();
                $(".linkTerms").click(function () {
                    $("#registration").hide();
                    $("#termsDiv").show();
                });
                $("#backTerms").click(function () {
                    $("#registration").show();
                    $("#termsDiv").hide();
                });
                $('form').submit(function (e) {
                    e.preventDefault()
                    var $this = $(this)
                    var name = $("#forename").val() + " " + $("#surname").val();
                    if ($("#notifications").prop('checked')) {
                        name = name + "*";
                    }
                    var submitData = new FormData();
                    submitData.append("email", $("#email").val());
                    submitData.append("name", name);
                    submitData.append("points", "1");
                    $.ajax({
                        post: $this.attr('action'),
                        url: "https://gewinnspiel.sonnenmoor.at/Register/register.php",
                        data: { email: $("#email").val(), username: name, points: window.points },
                        type: "POST",
                        processData: true,
                        contentType: false,
                        success: function (result) {
                            $("#finished").show();
                            $("#registration").hide();
                        },
                        error: function (request, status, errorThrown) {
                            $("#finished").show();
                            $("#finishedText").text("Leider hat etwas nicht funktioniert. Bitte versuchen Sie es später erneut.")
                            $("#registration").hide();
                        }
                    })
                })
                $("#backToWebsite").click(function () {
                    window.location.replace("https://www.sonnenmoor.at/");
                })
            }
            window.activateHTML = function () {
                $('#gameContainer').hide()
                $(".lastPart").css("display", "block");
                $("#registration").show();
            };
        </script>
    </div>
</body>
<script>
    const script = document.createElement('script')
    // Load Mobile
    if (startedMobile) {
        script.src = 'Build/UnityLoader.js'
    }
    //Load Desktop
    else {
        script.src = 'BuildDesktop/UnityLoader.js'
    }
    document.body.append(script)
    ///////// Handle cookies
    var open = window.XMLHttpRequest.prototype.open,
        send = window.XMLHttpRequest.prototype.send;
    function openReplacement(method, url, async, user, password) {
        this._url = url;
        return open.apply(this, arguments);
    }
    function sendReplacement(data) {
        if (this.onreadystatechange) {
            this._onreadystatechange = this.onreadystatechange;
        }
        this.onreadystatechange = onReadyStateChangeReplacement;
        if (!this._url.includes("unity3d")) {
            return send.apply(this, arguments);
        }
    }
    function onReadyStateChangeReplacement() {
        if (this._onreadystatechange) {
            return this._onreadystatechange.apply(this, arguments);
        }
    }
    window.XMLHttpRequest.prototype.open = openReplacement;
    window.XMLHttpRequest.prototype.send = sendReplacement;
    /////////////////////////////
    // Onload
    script.onload = () => {
        // First we get the viewport height and we multiple it by 1% to get a value for a vh unit
        let vh = window.innerHeight * 0.01;
        // Then we set the value in the --vh custom property to the root of the document
        document.documentElement.style.setProperty('--vh', `${vh}px`);
        // GameInstance
        var width = window.innerWidth
        var height = window.innerHeight
        var ratio = height / width
        var gameInstance
        if (startedMobile) {
            gameInstance = UnityLoader.instantiate("gameContainer", "Build/docs.json", { onProgress: UnityProgress });
        }
        else {
            gameInstance = UnityLoader.instantiate("gameContainer", "BuildDesktop/docs.json", { onProgress: UnityProgress });
        }
        function UnityProgress(gameInstance, progress) {
            if (!gameInstance.Module) {
                return;
            }
            const loader = document.querySelector("#loader");
            if (!gameInstance.progress) {
                const progress = document.querySelector("#loader .progress");
                progress.style.display = "block";
                gameInstance.progress = progress.querySelector(".full");
                loader.querySelector(".spinner").style.display = "none";
            }
            gameInstance.progress.style.transform = `scaleX(${progress})`;
            if (progress === 1 && !gameInstance.removeTimeout) {
                gameInstance.removeTimeout = setTimeout(function () {
                    loader.style.display = "none";
                }, 2000);
            }
        }
    }
</script>
</html>